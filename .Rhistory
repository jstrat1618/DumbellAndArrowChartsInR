geom_point(x=rep(2, num_teams), y=dat$rank20, col=is_gsw)
ggplot(dat)+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20, col=is_gsw)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=dat$rank20))
ggplot(dat)+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20, col=is_gsw)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20))
ggplot(dat)+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20, col=is_gsw)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))
ggplot(dat)+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20,
col=is_gsw, fill=is_gsw)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20))
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20))+
geom_point(x=rep(1, num_teams), y=rank19)
dat
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=AKA, x=rep(2.2, num_teams), y=rank20, hjust=1.1, size=3.5)
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(data=dat, label=AKA, x=rep(2.2, num_teams), y=rank20, hjust=1.1, size=3.5)
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#ffff00'))+
scale_fill_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)
source('~/Desktop/fun_projects/dumbell_chart/nba_plot.R', echo=TRUE)
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='Change in NBA Team Rankings')+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='Change in NBA Team Rankings')+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='Change in NBA Team Rankings')+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold')
plt2
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings')+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt2
?labs
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = "Golden State's Fall from 2019 to 2020 was steep,
but there's nowhere to go but up")+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = "Golden State's Fall from 2019 to 2020 was steep,
but there's nowhere to go but up")+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
caption.position = 'center',
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = "Golden State's Fall from 2019 to 2020 was steep,
but there's nowhere to go but up")+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
cpt <- "Golden State's Fall from 2019 to 2020 was steep,but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt2
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 12, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt2
cpt <- "Golden State's Fall from 2019 to 2020 was steep,
but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 12, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt2
cpt <- "Golden State's Fall from 2019 to 2020 was steep, but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt2
plt2+
scale_y_continuous(sec.axis = sec_axis(~., name = "mpg (UK)"))
plt2+
scale_y_discrete(sec.axis = sec_axis(~., name = "mpg (UK)"))
plt2
library(tidyverse)
df19 <- readxl::read_excel('data/nba_data.xlsx', sheet='2018-2019')
df20 <- readxl::read_excel('data/nba_data.xlsx', sheet='2019-2020')
num_teams <- nrow(df19)
# Check
num_teams == nrow(df20)
team_rank <- function(x)factor(x, levels = num_teams:1)
dat <-
df19 %>%
select(Team, PCT) %>%
rename(PCT19=PCT) %>%
mutate(rank19 = 1:num_teams)%>%
full_join(df20 %>%
select(Team, PCT, AKA) %>%
mutate(rank20 = 1:num_teams)%>%
rename(PCT20=PCT), by="Team") %>%
mutate(rank19 = team_rank(rank19),
rank20 = factor(rank20),
is_gsw = AKA == 'GSW')
cpt <- "Golden State's Fall from 2019 to 2020 was steep, but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
dat
library(tidyverse)
df19 <- readxl::read_excel('data/nba_data.xlsx', sheet='2018-2019')
df20 <- readxl::read_excel('data/nba_data.xlsx', sheet='2019-2020')
num_teams <- nrow(df19)
# Check
num_teams == nrow(df20)
team_rank <- function(x)factor(x, levels = num_teams:1)
dat <-
df19 %>%
select(Team, PCT) %>%
rename(PCT19=PCT) %>%
mutate(rank19 = 1:num_teams)%>%
full_join(df20 %>%
select(Team, PCT, AKA) %>%
mutate(rank20 = 1:num_teams)%>%
rename(PCT20=PCT), by="Team") %>%
mutate(rank19 = team_rank(rank19),
rank20 = factor(rank20),
is_gsw = AKA == 'GSW')
cpt <- "Golden State's Fall from 2019 to 2020 was steep, but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
df19 <- readxl::read_excel('data/nba_data.xlsx', sheet='2018-2019')
df20 <- readxl::read_excel('data/nba_data.xlsx', sheet='2019-2020')
num_teams <- nrow(df19)
# Check
num_teams == nrow(df20)
team_rank <- function(x)factor(x, levels = num_teams:1)
dat <-
df19 %>%
select(Team, PCT) %>%
rename(PCT19=PCT) %>%
mutate(rank19 = 1:num_teams)%>%
full_join(df20 %>%
select(Team, PCT, AKA) %>%
mutate(rank20 = 1:num_teams)%>%
rename(PCT20=PCT), by="Team") %>%
mutate(rank19 = team_rank(rank19),
rank20 = factor(rank20),
is_gsw = AKA == 'GSW')
cpt <- "Golden State's Fall from 2019 to 2020 was steep, but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
library(tidyverse)
df19 <- readxl::read_excel('data/nba_data.xlsx', sheet='2018-2019')
df20 <- readxl::read_excel('data/nba_data.xlsx', sheet='2019-2020')
num_teams <- nrow(df19)
# Check
num_teams == nrow(df20)
team_rank <- function(x)factor(x, levels = num_teams:1)
dat <-
df19 %>%
select(Team, PCT) %>%
rename(PCT19=PCT) %>%
mutate(rank19 = 1:num_teams)%>%
full_join(df20 %>%
select(Team, PCT, AKA) %>%
mutate(rank20 = 1:num_teams)%>%
rename(PCT20=PCT), by="Team") %>%
mutate(rank19 = team_rank(rank19),
rank20 = factor(rank20),
is_gsw = AKA == 'GSW')
cpt <- "Golden State's Fall from 2019 to 2020 was steep, but there's nowhere to go but up"
plt <-
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))+
xlim(0.5, 2.5)+
geom_text(label=dat$AKA, x=rep(2.2, num_teams), y=dat$rank20, hjust=1.1, size=3.5)+
geom_text(label=dat$AKA, x=rep(0.9, num_teams), y=dat$rank19, hjust=1.1, size=3.5)+
geom_point(aes(x=rep(2, num_teams), y=rank20, col=is_gsw))+
geom_point(x=rep(1, num_teams), y=dat$rank19)+
labs(x='', y='', title='NBA Team Rankings',
caption = cpt)+
theme(panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
legend.position = 'none',
plot.caption =  element_text(hjust = 0.5, size = 9, face='bold'),
plot.title =  element_text(hjust=0.5, size = 18, face='bold'))
plt
plt2 <-
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
plt2
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')
plt +
geom_text(x=0.6, y=team_rank(15), label="2019", fontface='bold',
col='black')+
geom_text(x=2.3, y=team_rank(15), label="2020", fontface='bold',
col='black')+
theme(axis.text.y = element_blank())
ggplot(dat, aes(col=is_gsw, fill=is_gsw))+
geom_segment(aes(x=1, xend=2, y=rank19, yend=rank20)) +
scale_color_manual(values = c('#cccccc', '#0000ff'))
plt
